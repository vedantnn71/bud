var{href:a}=window.location,{width:E,height:m}=window.screen,{userAgent:c}=navigator,{referrer:d}=document,l=`${E}x${m}`,{currentScript:e}=document;if(!e)throw new Error("Unable to get the bud script");var o=e.getAttribute("data-id"),u=e.getAttribute("data-website-name")??document.title;var b=e.getAttribute("data-endpoint")??"/api/collect";function h(){let t=new URL(e.getAttribute("src"));return`${t.protocol}//${t.host}`}var y=h(),p=y+b;if(!o)throw new Error("Missing tracking id");var v=0,s=!1,A=setInterval(()=>{s||(v+=500)},500);function w(){let t={id:o,url:a,visitTime:v,screen:l,referrer:d,userAgent:c,title:u,events:i};fetch(p,{method:"POST",body:JSON.stringify(t)})}document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&w()});var L=document.querySelectorAll("[data-event]"),i={};function x(t,r,n){t={...t,[n+"ed"]:!0},i={...i,[r]:t}}L.forEach(t=>{let r=t.getAttribute("data-event-name"),n=t.getAttribute("data-event"),g={};!r||!n||t.addEventListener(n,()=>x(g,r,n))});window.addEventListener("blur",async()=>{s=!0});window.addEventListener("focus",async()=>{s=!1});window.addEventListener("beforeunload",async()=>{clearInterval(A)});var f="";window.addEventListener("popstate",function(){f!==window.location.href&&w(),f=window.location.href});
