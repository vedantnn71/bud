var{href:c}=window.location,{width:v,height:b}=window.screen,{userAgent:d}=navigator,{referrer:a}=document,l=`${v}x${b}`,{currentScript:e}=document;if(!e)throw new Error("Unable to get the bud script");var o=e.getAttribute("data-id"),u=e.getAttribute("data-website-name")??document.title;var E=e.getAttribute("data-endpoint")??"/api/collect";function h(){let t=new URL(e.getAttribute("src"));return`${t.protocol}//${t.host}`}var A=h(),w=A+E;if(!(typeof window<"u"&&window.document))throw new Error("Not in browser");if(!o)throw new Error("Missing tracking id");var p=0,s=!1,L=setInterval(()=>{s||(p+=500)},500);function g(){let t={id:o,url:c,visitTime:p,screen:l,referrer:a,userAgent:d,title:u,events:i};fetch(w,{method:"POST",body:JSON.stringify(t)})}document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&g()});var x=document.querySelectorAll("[data-event]"),i={};function y(t,r,n){t={...t,[n+"ed"]:!0},i={...i,[r]:t}}x.forEach(t=>{let r=t.getAttribute("data-event-name"),n=t.getAttribute("data-event"),m={};!r||!n||t.addEventListener(n,()=>y(m,r,n))});window.addEventListener("blur",async()=>{s=!0});window.addEventListener("focus",async()=>{s=!1});window.addEventListener("beforeunload",async()=>{clearInterval(L)});var f="";window.addEventListener("popstate",function(){f!==window.location.href&&g(),f=window.location.href});
