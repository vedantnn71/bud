var{href:o}=window.location,{width:p,height:x}=window.screen,{userAgent:e}=navigator,{referrer:s}=document,d=`${p}x${x}`,c=m(),a=O(),f=b(),{currentScript:t}=document;if(!t)throw new Error("Unable to get the spark script");var r=t.getAttribute("data-website-id"),u=t.getAttribute("data-website-name")??document.title;function b(){return e.indexOf("Windows")>-1?"Windows":e.indexOf("Mac")>-1?"Mac":e.indexOf("X11")>-1?"Linux":"Unknown"}function m(){return e.indexOf("Opera")||e.indexOf("OPR")?"Opera":e.indexOf("Chrome")?"Chrome":e.indexOf("Safari")?"Safari":e.indexOf("Firefox")?"Firefox":e.indexOf("MSIE")||!!document.documentMode?"IE":"Unknown"}function O(){return/iPhone|iPad|iPod|Android/i.test(e)?"Mobile":"Desktop"}var h="http://localhost:3000/api",l=`${h}/collect`;if(!r)throw new Error("Missing website id");var w=0,n=!1,g=setInterval(()=>{n||(w+=500)},500);document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="hidden"){let i={websiteId:r,url:o,visitTime:w,screen:d,device:a,os:f,referrer:s,title:u,browser:c};fetch(l,{method:"POST",body:JSON.stringify(i)})}},{passive:!0});window.addEventListener("blur",async()=>{n=!0});window.addEventListener("focus",async()=>{n=!1});window.addEventListener("beforeunload",async()=>{clearInterval(g)});
